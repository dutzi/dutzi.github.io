{"componentChunkName":"component---src-templates-blog-post-js","path":"/utilizing-locize-for-i18n/","result":{"data":{"site":{"siteMetadata":{"title":"Things I've Learnt"}},"markdownRemark":{"id":"226e2c5a-c51e-5aa3-9cfe-411efb84110f","excerpt":"Dealing with i18n can be such a pain. It’s one of those things you barely touch so once you do you have to re-learn what you have forgotten since the last time…","html":"<p>Dealing with i18n can be such a pain. It’s one of those things you barely touch so once you do you have to re-learn what you have forgotten since the last time you visited it. You also need to decide who’s the source of truth, is it the code? the JSON? the translation service? You’ve got plurals (which for some languages are comprised of more than two variants), i18n keys (that can’t be minified), string interpolation, and on and on and on… All that so you can display a string in a bunch of languages.</p>\n<h2>In Comes I18next</h2>\n<p><a href=\"https://github.com/i18next/i18next\">I18next</a> is a framework for i18n. As defined in their <a href=\"https://www.i18next.com/\">docs</a>:</p>\n<blockquote>\n<p>i18next goes beyond just providing the standard i18n features such as (plurals, context, interpolation, format). It provides you with a complete solution to localize your product from web to mobile and desktop.</p>\n</blockquote>\n<p>Using i18next in conjunction with <a href=\"https://www.npmjs.com/package/react-i18next\">react-i18next</a> (there’s an Angular, Vue and even jQuery support, <a href=\"https://www.i18next.com/overview/supported-frameworks\">among others</a>) will help you maintain expressive code that’s i18n ready.</p>\n<p>Take a look at the following JSX:</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Just simple content</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  Hello </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>this is your name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">, you have </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> unread message(s). </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Link</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/msgs<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Go to messages</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Link</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">.\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Using react-i18next this is how it looks like after adding support for i18n:</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Just simple content'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Trans</span></span> <span class=\"token attr-name\">i18nKey</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>userMessagesUnread<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">count</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  Hello </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>strong</span> <span class=\"token attr-name\">title</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">'nameTitle'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>strong</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">, you have </span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"> unread message. </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Link</span></span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/msgs<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Go to messages</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Link</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">.\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Trans</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>You can either wrap a piece of string with a <code class=\"language-text\">t</code> function (which is returned by the <code class=\"language-text\">useTranslation</code> hook), or use the <code class=\"language-text\">&lt;Trans&gt;</code> component that can render children and inject them with the right values.</p>\n<p>The JSON for this component would look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"Just simple content\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Just simple content\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"userMessagesUnread\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Hello &lt;1>{{name}}&lt;/1>, you have {{count}} unread message. &lt;5>Go to message&lt;/5>.\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"userMessagesUnread_plural\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Hello &lt;1>{{name}}&lt;/1>, you have {{count}} unread messages.  &lt;5>Go to messages&lt;/5>.\"</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Notice how the key for “Just simple content” is the string itself. You might want to give it a key, perhaps something shorter, but this behavior is great for shorter strings (“Yes”, “No”, “Cancel”…) because it means they only get translated once.</p>\n<p>Also, notice how <code class=\"language-text\">&lt;Trans&gt;</code> break the JSX in a way that stands out for translators and can later be re-assembled and injected to the actual components.</p>\n<h3>Creating The JSON</h3>\n<p>Once you are done adding <code class=\"language-text\">t</code>’s and <code class=\"language-text\">&lt;Trans&gt;</code>’s, you can use <a href=\"https://github.com/i18next/i18next-scanner\">i18next-scanner</a>, which scans your code for references to i18next and generates a JSON with all the data, ready to be translated (it will merge into an existing JSON if one exists).</p>\n<p>It doesn’t support TypeScript, but for that you can use <a href=\"https://www.npmjs.com/package/compare-i18n\">compare-i18n</a> which does some of the work (it will only compare with an existing JSON but won’t add the keys).</p>\n<h2>Sending To Translators</h2>\n<p>I18next is a standard which is adopted by a few translation services, where I work at we chose to go with <a href=\"https://locize.com/\">Locize</a> that has <a href=\"https://www.onehourtranslation.com/\">One Hour Translation</a> (<strong>OHT</strong>) integration which makes translating a breeze.</p>\n<p>The way it works is as follows.</p>\n<p>We have two scripts defined in our <code class=\"language-text\">package.json</code>, one that syncs our main language’s JSON with what’s in Locize and one that downloads the other language’s translation files, after being translated.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"upload-translations\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"locize sync --project-id LOCIZE_PROJECT_ID --path src/translations\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"download-translations\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"locize download --project-id LOCIZE_PROJECT_ID --path src/translations\"</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Whenever we introduce new strings to our app, we run <code class=\"language-text\">upload-translations</code>, then within Locize’s console we get a quote from OHT, approve it, wait 24 hours and run <code class=\"language-text\">download-translations</code>. Simple, right?</p>\n<div class=\"dependencies\">\n<p><strong>Dependencies:</strong>\n<span class=\"dep\"><a href=\"https://www.npmjs.com/package/i18next\">i18next</a></span>\n<span class=\"dep\"><a href=\"https://www.npmjs.com/package/react-i18next\">react-i18next</a></span>\n<span class=\"dep\"><a href=\"https://github.com/i18next/i18next-scanner\">i18next-scanner</a></span>\n<span class=\"dep\"><a href=\"https://www.npmjs.com/package/compare-i18n\">compare-i18n</a></span></p>\n</div>","frontmatter":{"title":"Things I've Learnt Utilizing I18next","date":"January 06, 2020","description":"I18n can be a pain. This quick tutorial should give you enough to alleviate some of it."}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/utilizing-locize-for-i18n/","previous":{"fields":{"slug":"/css-in-js-vs-scss/"},"frontmatter":{"title":"Thoughts On CSS-in-JS"}},"next":null}}}